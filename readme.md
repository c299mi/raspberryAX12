# AX-12 Servo Control with Raspberry Pi

このプロジェクトは、Raspberry PiでAX-12サーボモーターを制御することを目的としています。

## 必要なハードウェア

- Raspberry Pi
- AX-12サーボモーター
- U2D2 USBシリアル変換インターフェース
- SMPS2Dynamixel電源供給ユニット

## セットアップ

1. U2D2をRaspberry PiのUSBポートに接続します。
2. SMPS2DynamixelをU2D2に接続します。
3. AX-12サーボをSMPS2Dynamixelに接続します。
4. SMPS2Dynamixelに適切な電源を供給します。

## ソフトウェアの準備

1. 必要なPythonライブラリをインストールします：
   ```
   sudo apt-get install python3-serial
   ```
2. プロジェクトディレクトリを作成し、その中にPythonスクリプトを配置します。

## 通信テストとIDスキャン

通信の確立とサーボIDの特定のために、統合されたテストプログラムを用意しています。

1. `ax12_comm_id_test.py`を実行します：
   ```
   python3 ax12_comm_id_test.py
   ```
   このプログラムは以下を行います：
   - 複数のボーレート（1000000, 115200, 57600, 9600）でテスト
   - 各ボーレートで、ID 0から252までのすべての可能なIDに対してPINGを送信
   - 応答があったサーボのボーレートとIDを表示

2. テスト結果に基づいて、正しいボーレートとサーボIDを特定します。

## AX-12制御プログラムの実行

1. テストで特定したボーレートとIDを使用して、`ax12_servo_control.py`を更新します。

2. 更新したAX-12制御スクリプトを実行します：
   ```
   python3 ax12_servo_control.py
   ```

## トラブルシューティング

通信の問題が発生した場合は、以下を確認してください：

1. 物理的な接続が正しいこと
2. 電源が正しく供給されていること
3. U2D2が正しく認識されていること（`ls -l /dev/ttyUSB*` で確認）
4. サーボのLEDが点灯していること

## 注意点

- AX-12サーボのデフォルトIDは1ですが、変更されている可能性があります。
- ボーレートは通常115200または1000000ですが、他の値も可能です。
- 通信テストプログラムを使用して、正確なボーレートとIDを特定してください。

## 今後の改善点

- 複数のサーボの同時制御
- より高度な動きのプログラミング
- エラーハンドリングの改善
- ユーザーインターフェースの追加（例：サーボ位置の視覚化）

このプロジェクトは継続的に改善されています。問題や提案がある場合は、イシューを作成してください。


# ゲームコントローラーのボタンと軸のマッピング

## ボタン（デジタル入力）
| ボタン | 番号 | 値 |
|--------|------|-----|
| A | 0 | 押す:1, 離す:0 |
| B | 1 | 押す:1, 離す:0 |
| X | 2 | 押す:1, 離す:0 |
| Y | 3 | 押す:1, 離す:0 |
| L1 | 4 | 押す:1, 離す:0 |
| R1 | 5 | 押す:1, 離す:0 |

## 軸（アナログ入力）
| 軸 | 番号 | 値の範囲 | 説明 |
|-----|------|-----------|-------|
| 左スティックX | 0 | -32767 ～ 32767 | 左:-32767, 中央:0, 右:32767 |
| 左スティックY | 1 | -32767 ～ 32767 | 上:-32767, 中央:0, 下:32767 |
| L2トリガー | 2 | -32767 ～ 32767 | 押してない:-32767, 全押し:32767 |
| 右スティックX | 3 | -32767 ～ 32767 | 左:-32767, 中央:0, 右:32767 |
| 右スティックY | 4 | -32767 ～ 32767 | 上:-32767, 中央:0, 下:32767 |
| R2トリガー | 5 | -32767 ～ 32767 | 押してない:-32767, 全押し:32767 |
| 十字キーX | 6 | -32767 ～ 32767 | 左:-32767, 中立:0, 右:32767 |
| 十字キーY | 7 | -32767 ～ 32767 | 上:-32767, 中立:0, 下:32767 |

## 特記事項
1. L2/R2は軸として扱われ、アナログ値を返します
2. スティックは両方とも各軸（X/Y）で-32767から32767の値を返します
3. 十字キーもアナログスティックと同様の値を返しますが、デジタル的な動作（最小値か最大値のみ）です
4. スティックを回転させると、X軸とY軸の値が連続的に変化します
